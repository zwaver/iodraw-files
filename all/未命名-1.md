```mermaid
graph TD
    %% 定义样式
    classDef layer fill:#f9f,stroke:#333,stroke-width:2px,color:black,font-weight:bold;
    classDef device fill:#d4e157,stroke:none,color:black;
    classDef edge fill:#4fc3f7,stroke:none,color:black;
    classDef cloud fill:#b39ddb,stroke:none,color:black;
    classDef external fill:#e0e0e0,stroke:#333,stroke-dasharray: 5 5,color:black;

    %% 外部系统
    subgraph External System [外部核心系统]
        TOS[码头生产核心系统 TOS]:::external
        ECS【】        
    end

    %% 应用层
    subgraph AppLayer [应用层: 多功能业务模块]
        %%direction LR
        App1(生产实时监控)
        App2(堆场优化建议)
        App3(故障预测维护)
        App4(沉浸式安全教育)
        App5(虚拟作业评估)
    end
    class AppLayer layer;

    %% 建模层 (通常部署在云端支持高算力渲染)
    subgraph ModelingLayer [建模层: 工业元宇宙底座]
        UE[虚幻引擎 Unreal Engine / 高保真渲染]
        subgraph Models [全要素模型]
            StaticModel[静态建模: 设备/环境几何]
            DynamicLogic[动态逻辑绑定: 行为/物理]
        end
        UE --> Models
    end
    class ModelingLayer layer;
    class UE,StaticModel,DynamicLogic cloud;

    %% 平台层 (云端核心)
    subgraph PlatformLayer [平台层: 数字孪生核心]
        DataMid[数字孪生数据中台]
        SimEngine[分布式仿真引擎]
        StreamProc[高并发实时数据流处理]
        
        DataMid <-->|深度融合| TOS
        DataMid --> SimEngine
        StreamProc --> DataMid
    end
    class PlatformLayer layer;
    class DataMid,SimEngine,StreamProc cloud;

    %% 感知层 (跨越端和边)
    subgraph PerceptionLayer [感知层: 全量数据采集]
        
        subgraph EdgeComputing [边侧: 近源处理]
            EdgeAI[视频AI识别分析]
            DataAggregation[边缘数据聚合 & 过滤]
        end
        
        subgraph DeviceSensors [端侧: 传感与连接]
            FiveG[5G 网络模组]
            LiDAR[激光雷达传感器]
            Camera[高清摄像头]
            IoT_PLC[设备状态传感器/PLC]
        end
    end
    class PerceptionLayer layer;
    class EdgeComputing,EdgeAI,DataAggregation edge;
    class DeviceSensors,FiveG,LiDAR,Camera,IoT_PLC device;

    %% 物理对象
    subgraph PhysicalLayer [物理实体对象]
        QC[岸桥 Quay Crane]
        YC[场桥 Yard Crane]
        AGV[自动导引车 AGV]
        Container[集装箱]
    end
    class QC,YC,AGV,Container external;

    %% 主要数据流向关系
    PhysicalLayer -->|物理安装| DeviceSensors

    Camera -->|视频流| EdgeAI
    LiDAR -->|点云数据| EdgeComputing
    IoT_PLC -->|状态参数| DataAggregation
    FiveG -->|低延迟传输通道| EdgeComputing

    EdgeComputing -->|结构化实时数据| StreamProc

    PlatformLayer -->|驱动数据 & 状态同步| DynamicLogic
    ModelingLayer -->|渲染画面/数据服务| AppLayer
    PlatformLayer -->|业务分析数据| AppLayer

    %% 图例
    subgraph Legend [图例: 部署位置]
        L_Device(端侧设备):::device
        L_Edge(边侧计算):::edge
        L_Cloud(云端中心):::cloud
    end

    style AppLayer fill:#fff,stroke:#666,stroke-width:1px,stroke-dasharray: 5 5
```